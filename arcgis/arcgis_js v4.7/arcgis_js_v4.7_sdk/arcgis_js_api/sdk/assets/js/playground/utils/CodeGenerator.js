/*! ArcGIS API for JavaScript 4.7 | Copyright (c) 2018 Esri. All rights reserved. | http://www.esri.com/legal/privacy | https://developers.arcgis.com/terms/faq */
define(["esri-playground-js/utils/ASTClasses"],function(e){function r(t,n){var i,p=t.type;if("Number"===p)return i=n>=0?e.getLiteral(Number(n)):o(Number(n));if("Boolean"===p)return i=e.getLiteral(n);if("String"===p)return i=t.options&&"constants"===t.options.type?a(t.options.className,n,!1):e.getLiteral(n);if("Color"===p){var u=e.getArrayExpression();return n.forEach(function(r){var t=e.getLiteral(r);u.elements.push(t)}),u}if("Object"===p){var f=e.getObjectExpression();if(n instanceof Object){var c=t.config,g=c?c.properties:t.properties;g.forEach(function(t){var i=t.name;if(null!=n[i]){var a=r(t,n[i]);if(a){var s=e.getProperty(e.getIdentifier(i),a);f.properties.push(s)}}})}return f.properties.length&&f}if("Array"===p){var u=e.getArrayExpression();return n.forEach(function(e,n){if(t.properties[n]){var i=r(t.properties[n],e);u.elements.push(i)}}),u.elements.length&&u||null}if("Class"===p){i=s(t.className||t.name),t.config.autocastType&&(i._autocastType=t.config.autocastType);var g=t.config.properties,f=e.getObjectExpression();return n instanceof Object&&g.forEach(function(t){var i=t.name;if(null!=n[i]){var a=r(t,n[i]);if(a){var s=e.getProperty(e.getIdentifier(i),a);f.properties.push(s)}}}),f.properties.length&&i.arguments.push(f),i}}function t(e){if(Array.isArray(e))return!e.length;var r=!0;for(var n in e)e.hasOwnProperty(n)&&"_watchCallbacks"!==n&&"className"!==n&&(e[n]instanceof Object?r=t(e[n]):null!=e[n]&&(r=!1));return r}var n=function(r,t){var n=e.getVariableDeclaration(e.Kind.VAR),i=e.getVariableDeclarator(),a=e.getNewExpression();return a.callee=e.getIdentifier(r),i.id=e.getIdentifier(t),i.init=a,n.declarations.push(i),n},i=function(r){var t=e.getVariableDeclaration(e.Kind.VAR),n=e.getVariableDeclarator(),i=e.getObjectExpression();return n.id=e.getIdentifier(r),n.init=i,t.declarations.push(n),t},a=function(r,t,n){var i=e.getMemberExpression(),a=e.getIdentifier(r),s=e.getIdentifier(t);return i.object=a,i.property=s,i.computed=n,i},s=function(r){var t=e.getNewExpression(),n=e.getIdentifier(r);return t.callee=n,t},o=function(r){var t=e.getUnaryExpression("-",!0),n=e.getLiteral(Math.abs(r));return t.argument=n,t},p={},u=function(r,t){var i=e.getProgram();return i.body.push(n(r,t)),i},f=function(r,t,n){var a=e.getProgram(),s=i(r),o=s.declarations[0].init.properties,p=e.getProperty(e.getIdentifier("type"),e.getLiteral(t));o.push(p);var u=n.body[0].declarations[0].init.arguments,f=u&&u[0]&&u[0].properties;return f&&f.forEach(function(r){if("ArrayExpression"===r.value.type){var t=e.getArrayExpression();r.value.elements.forEach(function(r){if("NewExpression"===r.type&&r._autocastType){var n=e.getObjectExpression(),i=e.getProperty(e.getIdentifier("type"),e.getLiteral(r._autocastType));n.properties.push(i);var a=r.arguments&&r.arguments[0]&&r.arguments[0].properties;a&&a.forEach(function(e){n.properties.push(e)}),t.elements.push(n)}else t.elements.push(r)});var n=e.getProperty(e.getIdentifier(r.key.name),t);o.push(n)}else o.push(r)}),a.body.push(s),a},c=function(n){if(n.ast){var i=n.ast,a=n.config,s=n.statefulObject,o=i.body[0].declarations[0].init.arguments=[];return a.properties.forEach(function(n){var i,a=n.name,p=s[a];if(!(null==p||p instanceof Object&&t(p))){var u=r(n,p);u&&(i=e.getProperty(e.getIdentifier(a),u),0===o.length&&o.push(e.getObjectExpression()),o[0].properties.push(i))}}),i}},g=function(e,r,t){if(e.className!==r)for(var n=0;n<e.properties.length;n++){var i=e.properties[n];if(r===i.name)return i;if("Class"===i.type&&i.className===r){if(g(i.config,r,t))return i}else if("Array"===i.type)for(var a=0;a<i.properties.length;a++){var s=i.properties[a];if(g(s.config,r,t))return i}}else for(var a=0;a<e.properties.length;a++){var s=e.properties[a];if(s.name===t)return s}return!1},l=function(e){return escodegen.generate(e,{format:{quotes:"double",compact:!0}})};return p.getAST=u,p.getAutocastAST=f,p.constructAST=c,p.getProperty=g,p.generateCode=l,p});