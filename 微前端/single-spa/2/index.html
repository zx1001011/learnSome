<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>测试 single-spa _ 探索原理</title>
</head>

<body>
    <!-- <h1>change route</h1>
    <a href="#/app1">aaaa</a>
    <a href="#/app2">sssss</a> -->
    <h1>js history change</h1>
    <a onclick="a()">aaaa</a>
    <a onclick="b()">sssss</a>
    <script src="/lib/umd/single-spa.js"></script>
    <script>
        function a() {
            history.pushState({}, '', '/a')
        }

        function b() {
            history.pushState({}, '', '/b')
        }


        singleSpa.registerApplication('app1', async () => {
                console.log('加载时执行')
                return {
                    bootstrap: [async (props) => {
                        console.log('bootstrap1')
                    }, async (props) => {
                        console.log('bootstrap1 --')
                    }],
                    mount: async (props) => {
                        console.log('mount1')
                    },
                    unmount: async (props) => {
                        console.log('unmount1')
                    }
                }
            },
            // location => location.hash.startsWith('#/app1'),
            location => location.pathname.startsWith('/a'), {
                store: {
                    name: 'zf',
                    age: 10
                }
            })
        singleSpa.registerApplication('app2', async () => {
                console.log('加载时执行2')
                return {
                    bootstrap: async () => {
                        console.log('bootstrap2')
                    },
                    mount: async () => {
                        console.log('mount2')
                    },
                    unmount: async (props) => {
                        console.log('unmount2')
                    }
                }
            },
            // location => location.hash.startsWith('#/app2'),
            location => location.pathname.startsWith('/b'), {
                store: {
                    name: '222',
                    age: 10
                }
            })
        singleSpa.start(); // 挂载应用
        window.addEventListener('hashchange', () => {
            console.log('路由切换了')
        })
    </script>
</body>

</html>